Include /etc/nginx/modsec/modsecurity.conf

# OWASP Core Rule Set (CRS) — path may vary by distro/container.
# In docker images, you’ll typically copy CRS to this path yourself.
Include /etc/nginx/modsec/crs/crs-setup.conf
Include /etc/nginx/modsec/crs/rules/*.conf

# Custom relaxations (keep strict by default)
SecRuleEngine On
SecRequestBodyLimit 1048576
SecResponseBodyAccess Off

# Example: allow JSON only
SecRule REQUEST_HEADERS:Content-Type "!@rx ^application/json(;.*)?$" "id:10001,phase:1,deny,status:415,msg:'Only application/json allowed'"
